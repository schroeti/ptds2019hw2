names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),"-",sigma),
as.character(paste0(rep("SD",11),"-",sigma))
rownames(All.portfolio) <- NULL
rownames(All.portfolio) <- NULL
All.portfolio
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),"-",sigma),
as.character(paste0(rep("SD",11),"-",sigma))))
rownames(All.portfolio) <- NULL
All.portfolio
paste0(rep("SD",11),"-",sigma)
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),"-",sigma)),
as.character(paste0(rep("SD",11),"-",sigma))))
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),"-",sigma)),
as.character(paste0(rep("SD",11),"-",sigma)))
All.portfolio
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),"-",sigma)),
as.character(paste0(rep("SD",11),"-",sigma)))
All.portfolio
head(All.portfolio)
rownames(All.portfolio) <- NULL
All.portfolio
min(All.portfolio[,14:24])
min(All.portfolio[,13:24])
min(All.portfolio[,14:24])
All.portfolio %>% mutate("Min" = (min(All.portfolio[,14:24]) == All.portfolio[,14:24]))
All.portfolio %>% mutate("Min" = (min(All.portfolio[,14:24]) == All.portfolio))
All.portfolio %>% mutate("Min" = (min(All.portfolio[,14:24]) == All.portfolio[,14:24])
All.portfolio
All.portfolio
All.portfolio %>% mutate("Min" = (min(All.portfolio[,14:24]) == All.portfolio[,14:24])
a<- All.portfolio %>% mutate("Min" = (min(All.portfolio[,14:24]) == All.portfolio[,14:24])
a<- All.portfolio %>% mutate("Min" = (min(All.portfolio[,14:24]) == All.portfolio[,14:24])
a
a <- All.portfolio %>% mutate("Min" = (min(All.portfolio[,14:24]) == All.portfolio[,14:24]))
All.portfolio %>% summarise(min = (min(All.portfolio[,14:24]) == All.portfolio[,14:24])))
All.portfolio %>% summarise(min = (min(All.portfolio[,14:24]) == All.portfolio[,14:24]))
min(All.portfolio[,14:24]) == All.portfolio[,14:24]
All.portfolio[min((All.portfolio[,14:24]) == All.portfolio[,14:24])]
All.portfolio[min((All.portfolio[,14:24]) == All.portfolio[,14:24]),]
All.portfolio[min((All.portfolio[,14:24]) == All.portfolio[,14:24]),min((All.portfolio[,14:24]) == All.portfolio[,14:24])]
All.portfolio[min((All.portfolio[,14:24]) == All.portfolio[,14:24]),min((All.portfolio[,14:24]) == All.portfolio[,14:24])]
All.portfolio[min((All.portfolio[,14:24]) == All.portfolio[,14:24]),]
All.portfolio[min((All.portfolio[,14:24]) == All.portfolio[,14:24])]
All.portfolio[min((All.portfolio[,14:24]) == All.portfolio[,14:24]),]
min((All.portfolio[,14:24])
min(All.portfolio[,14:24])
min(All.portfolio[,14:24])
All.portfolio[min((All.portfolio[,14:24]) == All.portfolio[,14:24]),]
All.portfolio[!min((All.portfolio[,14:24]) == All.portfolio[,14:24]),]
min((All.portfolio[,14:24]) == All.portfolio[,14:24])
min(All.portfolio[,14:24]) == All.portfolio[,14:24])
min((All.portfolio[,14:24]) == All.portfolio[,14:24])
All.portfolio
min(All.portfolio[,14:24]) == All.portfolio[,14:24])
min(All.portfolio[,14:24]) == All.portfolio[,14:24]
All.portfolio[min(All.portfolio[,14:24]) == All.portfolio[,14:24],]
min(All.portfolio[,14:24])
All.portfolio[,14:24]
min(All.portfolio[,14:24]) == All.portfolio[,14:24]
min(All.portfolio[,14:24]) == All.portfolio[,14:24]
All.portfolio[ All.portfolio == min(All.portfolio[,14:24]) ,]
All.portfolio == min(All.portfolio[,14:24])
min(All.portfolio[,14:24])
All.portfolio[All.portfolio == min(All.portfolio[,14:24]),]
count(min(All.portfolio[,14:24]) == All.portfolio[,14:24])
group_by(min(All.portfolio[,14:24]) == All.portfolio[,14:24])
summarize(min(All.portfolio[,14:24]) == All.portfolio[,14:24])
subset(All.portfolio, All.portfolio == min(All.portfolio[,14:24]))
All.portfolio
subset(All.portfolio, All.portfolio == min(All.portfolio[,14]))
min(All.portfolio[,14])
subset(All.portfolio, All.portfolio == min(All.portfolio[,14:24]))
min(All.portfolio[,14:24])
subset(All.portfolio, All.portfolio == 0.006901933)
subset(All.portfolio, All.portfolio == 0.0069)
All.portfolio %>% filter(All.portfolio == 0.0069 )
All.portfolio %>% filter(All.portfolio[,5] == 0.0069 )
All.portfolio %>% filter(All.portfolio[,14:24] == 0.0069 )
All.portfolio %>% filter(All.portfolio[,14:24] == 0.0069)
summarize(min(All.portfolio[,14:24]) == All.portfolio[,14:24])
(min(All.portfolio[,14:24]) == All.portfolio[,14:24])
r <-(min(All.portfolio[,14:24]) == All.portfolio[,14:24])
table(r)
min(All.portfolio[,14:24])
View(All.portfolio)
View(All.portfolio)
min(All.portfolio[,13:24])
min(All.portfolio[,14:24]) == All.portfolio
r <-(min(All.portfolio[,14:24]) == All.portfolio)
table(r)
r[TRUE]
min(All.portfolio[,14:24])
View(All.portfolio)
min(All.portfolio[,14:23])
min(All.portfolio[,14:20])
min(All.portfolio[,15:20])
min(All.portfolio[,16:20])
min(All.portfolio[,17:20])
min(All.portfolio[,18:20])
min(All.portfolio[,19:20])
min(All.portfolio[,20:20])
View(All.portfolio)
typeof(All.portfolio[,20:20])
typeof(All.portfolio[,10])
typeof(All.portfolio[,4])
typeof(All.portfolio[,1])
All.portfolio
as.character(paste0(rep("SD",11),"-",sigma))
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),"-",sigma)),
as.character(paste0(rep("SD",11),"-",sigma)))
rownames(All.portfolio) <- NULL
r <-(min(All.portfolio[,20:20]) == All.portfolio)
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = as.numeric(final.sd))
All.portfolio
as.numeric(final.sd)
typeof(All.portfolio[,166])
typeof(All.portfolio[,16])
All.portfolio
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
All.portfolio
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),"-",sigma)),
as.character(paste0(rep("SD",11),"-",sigma)))
rownames(All.portfolio) <- NULL
All.portfolio[, 3:24] <- sapply(All.portfolio[, 3:24], as.numeric)
All.portfolio %>% filter(All.portfolio[,14:24] == 0.0069)
min(All.portfolio[,20:20]) == All.portfolio
min(All.portfolio[,20:20])
View(All.portfolio)
min(All.portfolio[,10])
View(All.portfolio)
r <-(min(All.portfolio[,17]) == All.portfolio)
min(All.portfolio[,17])
All.portfolio[0.006978 == All.portfolio, ]
r <-(min(All.portfolio[,14:24]) == All.portfolio)
min(All.portfolio[,14:24]) == All.portfolio
All.portfolio[min(All.portfolio[,14:24]) == All.portfolio, ]
All.portfolio[0.0069 == All.portfolio, ]
All.portfolio[ All.portfolio == 0.0069 , ]
All.portfolio[All.portfolio[,14:24] == 0.0069 , ]
All.portfolio[All.portfolio[,14:24] == 0.0069,]
All.portfolio[,14:24] == 0.0069
subset(All.portfolio, All.portfolio == 0.0069)
subset(All.portfolio, All.portfolio[,14:24] == 0.0069)
subset(All.portfolio, All.portfolio[,17] == 0.0069)
subset(All.portfolio, All.portfolio[,17] == 0.0069788)
All.portfolio[All.portfolio[,17] == 0.0069788,]
All.portfolio[All.portfolio[,17] == 0.006978,]
All.portfolio[All.portfolio[,17] == 0.00697,]
All.portfolio[All.portfolio[,17] == 0.00697]
min(All.portfolio[,14:24]) == All.portfolio
All.portfolio[,17][All.portfolio[,17] == 0.00697]
All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.00697]
All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.00697]
All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.006978803]
All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.006978803]
All.portfolio[,17] == 0.006978803
All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.006978803,]
All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.006978803]
a <- All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.006978803]
a
All.portfolio[which.max(All.portfolio[,14:24],]
All.portfolio[which.max(All.portfolio[,14:24]),]
which.max(All.portfolio[,14:24])
All.portfolio[,14:24]
All.portfolio[, 3:24] <- sapply(All.portfolio[, 3:24], as.numeric())
All.portfolio[, 3:24] <- sapply(All.portfolio[, 3:24], as.numeric
All.portfolio[, 3:24] <- sapply(All.portfolio[, 3:24], as.numeric
All.portfolio[, 3:24] <- sapply(All.portfolio[, 3:24], as.numeric)
sapply(All.portfolio[, 14:24], min)
a <- All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.006978803]
a
a <- All.portfolio$`SD-0.3`[All.portfolio[,17] == "0.006978803"]
a
sapply(All.portfolio[, 14:24], min)
sapply(All.portfolio[, 14:24],1, min)
apply(All.portfolio[, 14:24],1, min)
apply(All.portfolio[, 14:24],2, min)
subset(All.portfolio, All.portfolio[,17] == 0.0069788)
All.portfolio <- tibble("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
All.portfolio
All.portfolio
All.portfolio <- as.tibble("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
All.portfolio <- tibble("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
All.portfolio
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),".",sigma)),
as.character(paste0(rep("SD",11),".",sigma)))
rownames(All.portfolio) <- NULL
All.portfolio
apply(All.portfolio[, 14:24],2, min)
a <- All.portfolio$`SD-0.3`[All.portfolio[,17] == 0.006978803]
a
a <- All.portfolio$`SD.0.3`[All.portfolio[,17] == 0.006978803]
a
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),".",sigma)),
as.character(paste0(rep("SD",11),".",sigma)))
a <- All.portfolio$`SD.0.3`[All.portfolio[,17] == 0.006978803]
a
for (i in 14:24 ) { All.portfolio %>% mutate(print("Min",i) = (min(All.portfolio[,i]) == All.portfolio[,i] )) }
for (i in 14:24 ) { All.portfolio %>% mutate(paste("Min",i) = (min(All.portfolio[,i]) == All.portfolio[,i] )) }
for (i in 14:24 ) { All.portfolio %>% mutate(paste("Min",i) = (min(All.portfolio[,i]) == All.portfolio[,i] )) }
All.portfolio %>% mutate(paste("Min",14) = (min(All.portfolio[,14]) == All.portfolio[,14] ))
paste("Min",14)
paste("Min",14)
(min(All.portfolio[,14]) == All.portfolio[,14] )
for (i in 14:24 ) {All.portfolio %>% mutate("Min_"i"" = (min(All.portfolio[,14]) == All.portfolio[,14] ))}
All.portfolio %>% mutate("Min" = (min(All.portfolio[,14]) == All.portfolio[,14] ))
apply(All.portfolio[, 14:24],2,function(x) min(All.portfolio[,x]) == All.portfolio[,x]))
apply(All.portfolio[, 14:24],2,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
All.portfolio[,3:24]<-apply(All.portfolio[,3:24],2, as.numeric)
apply(All.portfolio[,14:24],2,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
paste0(rep("SD",11),".",sigma))
paste0(rep("SD",11),".",sigma)
paste(rep("SD",11),".",sigma)
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
All.portfolio[,3:24]<-apply(All.portfolio[,3:24],2, as.numeric)
apply(All.portfolio[,14:24],2,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
a <- All.portfolio$`SD.0.3`[All.portfolio[,17] == 0.006978803]
a
subset(All.portfolio, All.portfolio[,17] == 0.0069788)
All.portfolio[,3:24]<-apply(All.portfolio[,3:24],2, function(x) signif(x, digits = 6))
All.portfolio
signif(All.portfolio[,3], digits = 66)
signif(All.portfolio[,3], digits = 6)
signif(All.portfolio[,3], digits = 3)
signif(All.portfolio[,3], digits = 2)
signif(All.portfolio[,3], digits = 1)
signif(All.portfolio[,3], digits = 3)
signif(All.portfolio[,3], digits = 4)
signif(All.portfolio[,3], digits = 5)
signif(All.portfolio[,3], digits = 6)
All.portfolio[,3:24]<-apply(All.portfolio[,3:24],2, function(x) signif(x, digits = 5))
All.portfolio
min(All.portfolio[,14:24])
a <- All.portfolio$Sd.3[All.portfolio[,17] == 0.006978803]
a
a <- All.portfolio$Sd.3[All.portfolio[,17] == min(All.portfolio[,14:24])]
a
min(All.portfolio[,14:24])
colMins(All.portfolio[,3:24], value = FALSE)
min.row <- row.names(All.portfolio)[(which(All.portfolio==min(All.portfolio[,14:24])))]
min.row
All.portfolio[(which(All.portfolio==min(All.portfolio[,14:24])))]
All.portfolio[,14:24]==min(All.portfolio[,14:24])
which(All.portfolio[,14:24]==min(All.portfolio[,14:24]))
All.portfolio[,14:24]==min(All.portfolio[,14:24]))
All.portfolio[,14:24]==min(All.portfolio[,14:24])
min(All.portfolio[,14:24]) == All.portfolio
a <- min(All.portfolio[,14:24]) == All.portfolio
a <- data.frame(min(All.portfolio[,14:24]) == All.portfolio)
a
a[TRUE]
a[a == TRUE,]
a[a == FALSE,]
a[a == TRUE,]
apply(All.portfolio[,3:24],2,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
apply(All.portfolio[,3:24], 3:24 ,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
apply(All.portfolio, 3:24 ,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
sapply(All.portfolio, 3:24 ,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
apply(All.portfolio, 2 ,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
apply(All.portfolio[,3:24], 2 ,function(x) min(All.portfolio[,x]) == All.portfolio[,x])
All.portfolio[,3:24]
apply(All.portfolio[,3:24], 2 , function(x) {min(All.portfolio[,x]) == All.portfolio[,x]})
min(All.portfolio[,3]) == All.portfolio[,3]
m<- NULL
apply(All.portfolio[,3:24], 2 , function(x) m[,x-2] <- min(All.portfolio[,x]) == All.portfolio[,x])
lapply(All.portfolio[,3:24], 2 , function(x) m[,x-2] <- min(All.portfolio[,x]) == All.portfolio[,x])
lapply(All.portfolio[,3:24],  function(x) m[,x-2] <- min(All.portfolio[,x]) == All.portfolio[,x])
lapply(All.portfolio[,3:24],  function(x) min(All.portfolio[,x]) == All.portfolio[,x])
sapply(All.portfolio[,3:24],  function(x) min(All.portfolio[,x]) == All.portfolio[,x])
subset(All.portfolio, All.portfolio[,17] == 0.0069788)
subset(All.portfolio, All.portfolio[,17:18] == 0.0069788)
subset(All.portfolio, All.portfolio[,14:24] == 0.0069788)
subset(All.portfolio, All.portfolio[,14:23] == 0.0069788)
subset(All.portfolio, All.portfolio[,16:23] == 0.0069788)
subset(All.portfolio, All.portfolio[,17:19] == 0.0069788)
min(All.portfolio[,14:24])
subset(All.portfolio, All.portfolio[,17:19] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,19:20] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,19:20] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,18:20] == min(All.portfolio[,14:24]))
min(All.portfolio[,14:24])
All.portfolio <- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Return" = final.return, "Sd" = final.sd)
All.portfolio[,3:24]<-apply(All.portfolio[,3:24],2, as.numeric)
All.portfolio[,3:24]<-apply(All.portfolio[,3:24],2, function(x) signif(x, digits = 8))
subset(All.portfolio, All.portfolio[,18:20] == min(All.portfolio[,14:24]))
min(All.portfolio[,14:24])
a<- NULL
for (i in 14:24 ) { a<- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
a
for (i in 14:24 ) { a[15-i] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
for (i in 14:24 ) { a[14-i] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
for (i in 14:24 ) { a[14-i] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
for (i in 14:24 ) { a[14-i,] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
a
for (i in 14:24 ) { a[15-i,] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
a <- NULL
for (i in 14:24 ) { a[15-i,] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
a <- NULL
for (i in 14:24 ) { a[14-i,] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
a <- matrix(nrow = 11, ncol = 24)
a
for (i in 14:24 ) { a[14-i,] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
a <- matrix(nrow = 11, ncol = 24)
for (i in 14:24 ) { a[15-i,] <- subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,14:24])) }
a
a[15-14,] <- subset(All.portfolio, All.portfolio[,14] == min(All.portfolio[,14:24]))
All.portfolio[,14] == min(All.portfolio[,14:24])
subset(All.portfolio, All.portfolio[,14] == min(All.portfolio[,14:24]))
a[15-14,] <- subset(All.portfolio, All.portfolio[,14] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,14] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,14:24] == min(All.portfolio[,14:24]))
ubset(All.portfolio, All.portfolio[,17] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,17] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,18] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,14:18] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,15:18] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,16:18] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,17:18] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,18:18] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,18:19] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,18:24] == min(All.portfolio[,14:24]))
for (i in 14:24 ) {a[15-i,] <-  subset(All.portfolio, All.portfolio[,i] == min(All.portfolio[,i])) }
All.portfolio
min(All.portfolio[,14:24])
subset(All.portfolio, All.portfolio[,14:24] == min(All.portfolio[,14:24]))
ap <- as.matrix(All.portfolio)
min(ap[,14:24])
ap <- as.matrix(All.portfolio[,14:24])
min(ap)
which.min(ap)
apply(ap,2,which.min)
ap[apply(ap,2,which.min),]
min(ap) %in% ap
for (i in 14:24 ) {a[15-i,] <-  subset(All.portfolio, All.portfolio[,18:24] == min(All.portfolio[,14:24])) }
subset(All.portfolio, All.portfolio[,18:24] == min(All.portfolio[,14:24]))
All.portfolio[,18:24] == min(All.portfolio[,14:24]))
All.portfolio[,18:24] == min(All.portfolio[,14:24])
colSums(All.portfolio[,18:24] == min(All.portfolio[,14:24]))
colSums(All.portfolio[,14:24] == min(All.portfolio[,14:24]))
All.portfolio
min(All.portfolio[,14:24])
All.portfolio[,14:24] == min(All.portfolio[,14:24])
subset(All.portfolio, All.portfolio[,14:24] == min(All.portfolio[,14:24]))
subset(All.portfolio, All.portfolio[,18:24] == min(All.portfolio[,14:24]))
All.portfolio == min(All.portfolio[,14:24])
subset(All.portfolio, All.portfolio == min(All.portfolio[,14:24]))
min(All.portfolio[,14:24])
which(min(All.portfolio[,14:24])))
which(min(All.portfolio[,14:24]))
which(All.portfolio == min(All.portfolio[,14:24]))
library(ggplot2)
#install.packages("ggrepel")
library(ggrepel)
theme_set(theme_bw())
df<- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Variance" = final.sd[,6], "ret" = final.return[,6])
df %>% mutate("Min" = (min(Variance) == Variance ))  %>% mutate(Portfolio = ifelse(Min == TRUE, as.character(paste(company.1,company.2,sep = "-")), NA)) -> df
ggplot(df, aes(Variance, ret, color = Min, alpha = Min))+
scale_color_discrete(name = NULL, labels = c("Autre Portfolio", "Min variance Portfolio")) +
scale_alpha_manual(values = c(0.01,1), guide=FALSE)+
geom_label(label = df$Portfolio,
nudge_x = 0.00 , nudge_y = 0.0002,
check_overlap = F, size = 2,
color = "#00AFBB",fontface = "bold")+
geom_point()
df
ggplot(df, aes(Variance, ret, color = Min, alpha = Min))+
scale_color_discrete(name = NULL, labels = c("Autre Portfolio", "Min variance Portfolio")) +
scale_alpha_manual(values = c(0.01,1), guide=FALSE)+
geom_label(label = df$Portfolio,
nudge_x = 0.00 , nudge_y = 0.0002,
check_overlap = F, size = 2,
color = "#00AFBB",fontface = "bold")+
geom_point()
df
ggplot(df, aes(Variance, ret, color = Min, alpha = Min))+
scale_color_discrete(name = NULL, labels = c("Autre Portfolio", "Min variance Portfolio")) +
scale_alpha_manual(values = c(0.01,1), guide=FALSE)+
geom_label(label = df$Portfolio,
nudge_x = 0.00 , nudge_y = 0.0002,
check_overlap = F, size = 2,
color = "#00AFBB",fontface = "bold")+
geom_point()
All.portfolio
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),".",sigma)),
as.character(paste(rep("SD",11),".",sigma)))
All.portfolio
as.character(paste0(rep("Exp_R",11),".",sigma)
as.character(paste0(rep("Exp_R",11),".",sigma))
as.character(paste0(rep("Exp_R",11),".",sigma))
reshape(All.portfolio, direction="long",
varying=list(c(as.character(paste0(rep("Exp_R",11),".",sigma))),
as.character(paste(rep("SD",11),".",sigma))),
v.names=c("Return","SD"))
All.portfolio
gather(All.portfolio, Return, Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio, Return, Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,1:13], Return,Portfolio, Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
All.portfolio
names(All.portfolio) <- c("company.1", "company.2", as.character(paste0(rep("Exp_R",11),".",sigma)),
as.character(paste0(rep("SD",11),".",sigma)))
All.portfolio
gather(All.portfolio[,14:24],Portfolio, SD , SD.0.1:SD.1, factor_key=TRUE)
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,14:24],Portfolio, SD , SD.0.1:SD.1, factor_key=TRUE)[]
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,14:24],Portfolio, SD , SD.0.1:SD.1, factor_key=TRUE)[,2:3]
cbind(gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE),gather(All.portfolio[,14:24],Portfolio, SD , SD.0.1:SD.1, factor_key=TRUE)[,2:3])
cbind(gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
cbind(gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,14:24],Portfolio, SD , SD.0.1:SD.1, factor_key=TRUE)[,2:3]
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0.1:SD.1, factor_key=TRUE)[,2:3]
c(1:2,14:24)
14:24
1:2
1:13
14:24
c(1:2,14:24)
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0.1:SD.1, factor_key=TRUE)
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0.1:SD.1, factor_key=TRUE)
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)
left_join(gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE), gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE))
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)
gather(All.portfolio[,1:13],Portfolio, Return , Exp_R.0:Exp_R.1, factor_key=TRUE)
names(All.portfolio) <- c("company.1", "company.2", sigma),
names(All.portfolio) <- c("company.1", "company.2", sigma,sigma)
All.portfolio
names(All.portfolio) <- c("company.1", "company.2", sigma,paste0(".",sigma))
All.portfolio
gather(All.portfolio[,1:13],Portfolio, Return , 0:1, factor_key=TRUE)
names(All.portfolio) <- c("company.1", "company.2", paste0(",",sigma),paste0(".",sigma))
paste0(R,",",sigma)
paste0("R",",",sigma)
names(All.portfolio) <- c("company.1", "company.2", paste0("R",".",sigma),paste0("SD",".",sigma))
gather(All.portfolio[,1:13],Portfolio, Return , R.0:R.1, factor_key=TRUE)
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)
gather(All.portfolio[,1:13],Portfolio, Return , R.0:R.1, factor_key=TRUE)
left_join(gather(All.portfolio[,1:13],Portfolio, Return , R.0:R.1, factor_key=TRUE),gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,-3])
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)
left_join(gather(All.portfolio[,1:13],Portfolio, Return , R.0:R.1, factor_key=TRUE),gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,-3])
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,-3]
gather(All.portfolio[,1:13],Portfolio, Return , R.0:R.1, factor_key=TRUE)
gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)
cbind(gather(All.portfolio[,1:13],Portfolio, Return , R.0:R.1, factor_key=TRUE),gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,4])
cbind(gather(All.portfolio[,1:13],Portfolio, Return , R.0:R.1, "SD"= factor_key=TRUE),gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,4])
cbind(gather(All.portfolio[,1:13],Portfolio, Return , R.0:R.1, factor_key=TRUE),  "SD" =gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,4])
cbind(gather(All.portfolio[,1:13],Weight, Return , R.0:R.1, factor_key=TRUE),  "SD" =gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,4])
All.portfolio.long <- cbind(gather(All.portfolio[,1:13],Weight, Return , R.0:R.1, factor_key=TRUE),  "SD" =gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,4])
All.portfolio.long
All.portfolio.long <- cbind(gather(All.portfolio[,1:13],Weight.Company.1 , Return , R.0:R.1, factor_key=TRUE),  "SD" =gather(All.portfolio[,c(1:2,14:24)],Portfolio, SD , SD.0:SD.1, factor_key=TRUE)[,4])
All.portfolio.long
min(All.portfolio.long$SD)
All.portfolio.long
All.portfolio.long$SD[All.portfolio.long[,5] == min(All.portfolio.long[,3])]
All.portfolio.long[,5] == min(All.portfolio.long[,3]
All.portfolio.long$SD[All.portfolio.long[,5] == min(All.portfolio.long[,3]),]
All.portfolio.long[All.portfolio.long[,5] == min(All.portfolio.long[,3]),]
All.portfolio.long[,5] == min(All.portfolio.long[,3])
All.portfolio.long[All.portfolio.long[,5] == min(All.portfolio.long[,5]),]
All.portfolio.long[All.portfolio.long[,5] == min(All.portfolio.long[,5]),]
best.portfolio <- All.portfolio.long[All.portfolio.long[,5] == min(All.portfolio.long[,5]),]
best.portfolio
lowerSD.portfolio <- All.portfolio.long[All.portfolio.long[,5] == min(All.portfolio.long[,5]),]
lowerSD.portfolio
round(lowerSD.portfolio$SD, digits = 0)
round(lowerSD.portfolio$SD, digits = 4)
round(lowerSD.portfolio$SD, digits = 5)
round(lowerSD.portfolio$SD, digits = 6)
round(lowerSD.portfolio$SD, digits = 4)
lowerSD.portfolio
round(lowerSD.portfolio$SD, digits = 4)
round(lowerSD.portfolio$SD, digits = 4)*1000000
round(lowerSD.portfolio$SD, digits = 4)*1000000
lowerSD.portfolio
library(ggplot2)
#install.packages("ggrepel")
library(ggrepel)
theme_set(theme_bw())
df<- data.frame("company.1" = return.clean$Company.1,"company.2" = return.clean$Company.2, "Variance" = final.sd[,5], "ret" = final.return[,5])
df %>% mutate("Min" = (min(Variance) == Variance ))  %>% mutate(Portfolio = ifelse(Min == TRUE, as.character(paste(company.1,company.2,sep = "-")), NA)) -> df
ggplot(df, aes(Variance, ret, color = Min, alpha = Min))+
scale_color_discrete(name = NULL, labels = c("Autre Portfolio", "Min variance Portfolio")) +
scale_alpha_manual(values = c(0.01,1), guide=FALSE)+
geom_label(label = df$Portfolio,
nudge_x = 0.00 , nudge_y = 0.0002,
check_overlap = F, size = 2,
color = "#00AFBB",fontface = "bold")+
geom_point()
lowerSD.portfolio$Weight.Company.1<- gsub('R.', '', lowerSD.portfolio$Weight.Company.1)
lowerSD.portfolio
(1-lowerSD.portfolio$Weight.Company.1)
lowerSD.portfolio$Weight.Company.1
(1-as.numeric(lowerSD.portfolio$Weight.Company.1))
install.packages("rmdformats")
install.packages("rmdformats")
install.packages("rmdformats")
install.packages("rmdformats")
library("rmdformats")
library(rmdformats)
install.packages("rmdformats")
